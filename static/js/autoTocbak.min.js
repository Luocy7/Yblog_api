(function(b,c){function a(){this.settings={tocContainer:"#catalog",postContainer:"#article"};this.cateTopInit=c(".sticky-block-box").offset().top;this.createToc();this.bindClick();this.bindEvents()}a.prototype={createToc:function(){var d=["<dl class='catalog-list'>"];var e,g;var f=c(this.settings.postContainer).find("h2,h3,h4");if(!f.get(0)){c(".sticky-block-box").css("visibility","hidden")}f.each(function(h,j){if("h2"===c(j).prop("tagName").toLowerCase()){g="dt";e="level1"}else{if("h3"===c(j).prop("tagName").toLowerCase()){g="dd";e="level2"}else{g="dd";e="level3"}}var i="<"+g+' class="toc-title '+e+'"><a class="toca" href=\'javascript:void(0)\'>'+c(j).text()+"</a></"+g+">";d.push(i)});c(this.settings.tocContainer).html(d.join(""))},bindClick:function(){var g=this;var f=c(this.settings.postContainer).find("h2,h3,h4");var d=c(this.settings.tocContainer);var e=c("#sidebar");d.find(".toca").each(function(i,h){c(h).parent().on("click",function(){c(b).scrollTop(f.eq(i).offset().top-100);var j=c(document).scrollTop()-g.cateTopInit+1;console.log(j);j>0?e.addClass("sticky"):e.removeClass("sticky")})})},bindEvents:function(){var d=this;c(document).scroll(function(){d.locateCataByContent()})},locateCataByContent:function(){var k=c(this.settings.postContainer);var f=k.find("h2,h3,h4");var l=c(document).scrollTop();var e=c(".catalog-list");for(var g=0,d=f.length;g<d;g++){var j=f[g],h=f[g+1];if(c(j).offset().top-101<=l&&((g+1===d)||((g+1<d)&&c(h).offset().top>l))){e.find(".active").removeClass("active");e.children().eq(g).addClass("active")}}}};b.SideCatalog=a;c.fn.sideCatalog=function(){var d=new a();return c(this)}})(window,jQuery);$("#sidetoc").sideCatalog();